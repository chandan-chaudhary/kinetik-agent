# REST client for trading-bot API
# Usage: open this file in VS Code with the REST Client extension and click "Send Request" above the request.
# Set the HOST variable below if you run locally (change if your app uses a different port)
@HOST = http://localhost:3000


### Register a new user
POST {{HOST}}/api/auth/register
Content-Type: application/json

{
  "email": "chandan@gmail.com",
  "name": "Chandan",
  "password": "test123",
"profilePicture": "https://i.pravatar.cc/300"
}

### Login (returns safe user object)
POST {{HOST}}/api/auth/login
Content-Type: application/json

{
  "email": "alice@example.com",
  "password": "strongpassword"
}

### List users (no password fields)
GET {{HOST}}/api/users

### Create user (legacy endpoint) - also hashes password
POST {{HOST}}/api/users
Content-Type: application/json

{
  "email": "bob@example.com",
  "name": "Bob",
  "password": "anotherpass",
  "profile": "Optional"
}

### Create a Demat Credential (for a user)
POST {{HOST}}/api/demat-credentials
Content-Type: application/json

{
  "userId": "693bedce778fd42e6cbf3f16",
  "accountName": "Delta Exchange",
  "credentials": { "apiKey": "abc", "secret": "xyz" }
}

### List Demat credentials for user
GET {{HOST}}/api/demat-credentials?userId=693bedce778fd42e6cbf3f16

### Get one Demat credential by id
GET {{HOST}}/api/demat-credentials/693bee25778fd42e6cbf3f17

### Update Demat credential (patch accountName and/or credentials)
PATCH {{HOST}}/api/demat-credentials/693bee25778fd42e6cbf3f17
Content-Type: application/json

{
  "accountName": "Updated Name",
  "credentials": { "apiKey": "new", "secret": "newsecret" }
}

### Create a workflow with nested nodes (atomic)
POST {{HOST}}/api/workflows
Content-Type: application/json

{
  "userId": "693bedce778fd42e6cbf3f16",
  "name": "Sample Workflow",
  "nodes": [
    {
      "nodeId": "693c13c97d9660f76d9c11a9",
      "id": "node-1",
      "position": { "x": 0, "y": 0 },
      "data": { "kind": "Trigger", "metadata": { "asset": "BTC", "price": 30000 } }
    },
    {
     "nodeId": "693c13457d9660f76d9c11a8",
      "id": "node-2",
      "position": { "x": 200, "y": 200 },
      "credential": { "email": "delta@gmail.com", "password": "your-password" },
      "data": { "kind": "Action", "metadata": { "type": "LONG", "quantity": 0.01 } }
    }
  ],
  "edges": [
    { "id": "e1", "source": "node-1", "target": "node-2" }
  ]
}

### ==================== Node Endpoints ====================

### Get all nodes (with optional filters)
GET {{HOST}}/api/nodes?limit=20&offset=0&type=Action

### Get all trigger nodes
GET {{HOST}}/api/nodes?type=Trigger

### Create a new node
POST {{HOST}}/api/nodes
Content-Type: application/json

{
  "title": "Price Trigger",
  "description": "Triggers when price crosses threshold",
  "type": "Trigger",
  "credentialTypes": []
}


### Create a new node
POST {{HOST}}/api/nodes
Content-Type: application/json

{
  "title": "Delta Exchange",
  "description": "Place order on Delta Exchange",
  "type": "Action",
  "credentialTypes": [ { "email": "delta@gmail.com", "password": "your-password" } ]
}
 ### "title": "Delta Exchange",

### Get a single node by ID
GET {{HOST}}/api/nodes/<NODE_ID>

### Update a node by ID
PATCH {{HOST}}/api/nodes/<NODE_ID>
Content-Type: application/json

{
  "title": "Updated Node Title",
  "description": "Updated description"
}

### Delete a node by ID
DELETE {{HOST}}/api/nodes/693c12ca7d9660f76d9c11a7

### Notes
# - Replace {{HOST}} with http://localhost:3000 or your deployed URL.
# - Replace <USER_ID>, <DEMAT_ID>, <NODE_ID> etc. with actual ids returned by the API.
# - The workflows endpoint will create nodes nested inside the workflow; node IDs returned will be Prisma-generated strings.
# - If you want JWT/session auth wired, update these requests to include Authorization headers once implemented.
